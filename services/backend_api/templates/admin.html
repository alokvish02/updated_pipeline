<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard</title>
  <!-- Uncomment Bootstrap if needed -->
  <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"> -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.socket.io/4.4.1/socket.io.min.js"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/nav_side.css') }}">
</head>
<body>
  <div class="navbar">
    <!-- Centered Live Clock -->
    <div class="live-clock" id="liveTime"></div>
    <nav>
      <a href="/" class="performance-btn">Dashboard</a>
      <a href="/chart" class="performance-btn">Charts</a>
      <a href="/admin/dashboard" class="performance-btn">Admin</a>
      <div class="exchange-dropdown d-flex flex-wrap">
          <select id="exchange-type" name="exchange-type" class="filter-btn">
            <option id="nse-filter-btn" value="nse">NSE</option>
            <option id="crypto-filter-btn" value="binance">CRYPTO</option>
            <option id="snp-filter-btn" value="snp">S&P</option>
            <option id="etf-filter-btn" value="etf">ETF</option>
          </select>
      </div>
    </nav>
    <div class="theme-switch-wrapper">
      <label class="theme-switch" for="theme-toggleInchart" aria-label="Toggle theme">
        <input type="checkbox" id="theme-toggleInchart" />
        <span class="slider round"></span>
      </label>
    </div>
  </div>
  <hr class="navbar-line">

    <div class="dashboard-container">
      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="sidebar-header">
          <img src="https://www.theonealpha.com/uploads/logo.png" alt="Logo" class="brand-logo">
        </div>
        <nav class="sidebar-nav">
          <!-- Uncomment and adjust links as needed -->
          <!-- <a href="/" class="nav-item {% if active_page == 'dashboard' %}active{% endif %}">üìä Dashboard</a>
          <a href="/chart" class="nav-item {% if active_page == 'chart' %}active{% endif %}">üìà Charts</a>
          <a href="/admin/dashboard" class="nav-item {% if active_page == 'admin' %}active{% endif %}">‚öôÔ∏è Admin</a> -->
        </nav>
      </aside>

      <div id="connectionStatus" style="text-align:center; margin-top: 10px; font-weight: bold;"></div>
        <br>
        <div class="container">
          <!-- Control Panel -->
          <div class="control-panel">
            <div class="d-flex justify-content-between">
              <h3>Pipeline Control</h3>
              <div class="status-indicator {% if pipeline_status %}status-active{% else %}status-inactive{% endif %}"></div>
            </div>
            <div class="d-flex flex-wrap">
              <select class="form-select btn-custom" id="exchangeSelect">
                <!-- Options will be dynamically populated by JavaScript -->
              </select>
              <button class="btn btn-custom" id="startPipelineBtn" onclick="controlPipeline('start')">Start</button>
              <button class="btn btn-custom" onclick="controlPipeline('stop')">Stop</button>
            </div>
          </div>

<!-- Symbol Selection Mode -->
    <div class="card mb-4">
      <div class="card-header">Symbol Selection Mode</div>
      <div class="card-body">
        <div class="btn-group w-100" role="group" aria-label="Symbol Selection Mode">
          <input type="radio" class="btn-check" name="symbolMode" id="manualMode" autocomplete="off" checked>
          <label class="btn btn-outline-primary w-50" for="manualMode">Manual</label>
          <input type="radio" class="btn-check" name="symbolMode" id="automaticMode" autocomplete="off">
          <label class="btn btn-outline-primary w-50" for="automaticMode">Automatic</label>
        </div>
      </div>
    </div>

  <!-- Update User Pairs -->
      <div class="card mb-4">
        <div class="card-header">Update User Pairs</div>
        <div class="card-body">
          <form id="userPairsForm">
            <div class="mb-3">
              <label class="form-label">Select Symbol Type</label>
              <div class="btn-group w-100" role="group" aria-label="Symbol Type">
                <input type="radio" class="btn-check" name="symbolType" id="nseSymbol" autocomplete="off" checked>
                <label class="btn btn-outline-primary w-50" for="nseSymbol">NSE Symbol</label>
                <input type="radio" class="btn-check" name="symbolType" id="binanceSymbol" autocomplete="off">
                <label class="btn btn-outline-primary w-50" for="binanceSymbol">Binance Symbol</label>
                <input type="radio" class="btn-check" name="symbolType" id="snpSymbol" autocomplete="off">
                <label class="btn btn-outline-primary w-50" for="snpSymbol">Snp Symbol</label>
                <input type="radio" class="btn-check" name="symbolType" id="etfSymbol" autocomplete="off">
                <label class="btn btn-outline-primary w-50" for="etfSymbol">Etf Symbol</label>
              </div>
            </div>
            <div class="mb-3">
              <label for="user_pairs" class="form-label">Enter Pairs Name</label>
              <textarea id="user_pairs" class="form-control p-2" rows="3" placeholder="e.g., BTCUSDT,ETHUSDT\nBTCUSDT,TAOUSDT"></textarea>
              <small class="text-muted">Format: each line = one pair, symbols comma-separated</small>
            </div>
            <button type="submit" class="btn btn-primary" id="saveUserPairsBtn">Save User Pairs</button>
          </form>
        </div>
      </div>



      <!-- Total Capital Update -->
      <div class="card mb-4">
        <div class="card-header">Update Algorithm Parameters</div>
        <div class="card-body">
          <form id="totalCapitalForm" class="row align-items-center">
            <div class="col-auto">
              <label for="total_capital" class="form-label">Account Capital</label>
              <input type="number" class="form-control p-2" id="total_capital" name="total_capital" value="100000" placeholder="Enter total capital">
            </div>
            <div class="col-auto">
              <label for="pos_val" class="form-label">Pos. Val</label>
              <input type="number" class="form-control p-2" id="pos_val" name="pos_val" value="2" placeholder="Enter pos.val">
            </div>
            <div class="col-auto">
              <label for="lookback" class="form-label">std</label>
              <input type="number" class="form-control p-2" id="std" name="std" value="2" placeholder="Enter std value">
            </div>
            <div class="col-auto">
              <label for="lookback" class="form-label">Lookback</label>
              <input type="number" class="form-control p-2" id="lookback" name="lookback" value="1700" placeholder="Enter lookback value">
            </div>
            <div class="col-auto">
              <label for="lookback" class="form-label">Fast_std</label>
              <input type="number" class="form-control p-2" id="faststd" name="std" value="4" placeholder="Enter std value">
            </div>
            <div class="col-auto">
              <label for="lookback" class="form-label">Fast_Lookback</label>
              <input type="number" class="form-control p-2" id="fastlookback" name="lookback" value="1700" placeholder="Enter lookback value">
            </div>
            <div class="col-auto">
              <label for="lookback" class="form-label">Strategy Name</label>
              <input type="text" class="form-control p-2" id="strategyname" value="band" placeholder="Enter lookback value">
            </div>
            <div class="col-auto">
              <label for="window" class="form-label">Window</label>
              <input type="number" class="form-control p-2" id="window" name="window" value="20" placeholder="Enter window value">
            </div>
            <div class="col-auto">
              <label for="from_date" class="form-label">From Date</label>
              <input type="date" class="form-control p-2" id="from_date" name="from_date" value="2024-01-01">
            </div>
            <div class="col-auto">
              <label for="to_date" class="form-label">To Date</label>
              <input type="date" class="form-control p-2" id="to_date" name="to_date" value="2025-04-10">
            </div>
            <div class="col-auto mt-4">
              <button type="button" class="btn btn-primary" onclick="saveTotalCapital()">Save</button>
            </div>
          </form>
        </div>
      </div>
      <!-- System Configuration -->
      <div class="card mb-4">
        <div class="card-header">System Configuration</div>
        <div class="card-body">
          <form id="systemConfigForm" class="row align-items-center">
            <div class="col-auto">
              <label for="max_cpu_cores" class="form-label">Max CPU Cores</label>
              <input type="number" class="form-control" id="max_cpu_cores" name="max_cpu_cores" value="8" min="1">
            </div>
            <div class="col-auto">
              <label for="memory_limit_gb" class="form-label">Memory Limit (GB)</label>
              <input type="number" class="form-control" id="memory_limit_gb" name="memory_limit_gb" value="8" min="1">
            </div>
            <div class="col-auto">
              <label for="process_ttl" class="form-label">Process TTL (seconds)</label>
              <input type="number" class="form-control" id="process_ttl" name="process_ttl" value="300" min="1">
            </div>
            <div class="col-auto">
              <label for="system_monitor_interval" class="form-label">Monitor Interval (sec)</label>
              <input type="number" class="form-control" id="system_monitor_interval" name="system_monitor_interval" value="5" min="1">
            </div>
            <div class="col-auto">
              <label for="max_restart_attempts" class="form-label">Max Restart Attempts</label>
              <input type="number" class="form-control" id="max_restart_attempts" name="max_restart_attempts" value="3" min="0">
            </div>
            <div class="col-auto">
              <button type="button" class="btn btn-primary" onclick="saveSystemConfig()">Save Configuration</button>
            </div>
          </form>
        </div>
      </div>

      <!-- Hardware Metrics -->
      <div class="card mb-4">
        <div class="card-header">System Metrics</div>
        <div class="card-body">
          <div class="row mb-4">
            <div class="col-md-4">
              <h5>CPU Usage</h5>
              <div class="progress" style="height: 30px;">
                <div id="cpuProgress" class="progress-bar" role="progressbar" style="width: 0%">0%</div>
              </div>
            </div>
            <div class="col-md-4">
              <h5>Memory Usage</h5>
              <div class="progress" style="height: 30px;">
                <div id="memoryProgress" class="progress-bar" role="progressbar" style="width: 0%">0%</div>
              </div>
            </div>
            <div class="col-md-4">
              <h5>Load Average</h5>
              <div id="loadAvg" class="h4">0, 0, 0</div>
            </div>
          </div>
          <div class="chart-container">
            <canvas id="performanceChart"></canvas>
          </div>
        </div>
      </div>

      <!-- Process Table -->
      <div class="card">
        <div class="card-header">System Processes</div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-dark table-hover">
              <thead>
                <tr>
                  <th>Process</th>
                  <th>Status</th>
                  <th>PID</th>
                  <th>Uptime</th>
                  <th>Last Ping</th>
<!--                  <th>Actions</th>-->
                </tr>
              </thead>
              <tbody id="processTable">
                <!-- Dynamically populated -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
          <!-- Complete System Status Card -->
  <div class="card mb-4">
    <div class="card-header">Complete System Status</div>
    <div class="card-body" id="completeStatus">
      Loading status...
    </div>
  </div>
    </div>
    <script src="{{ url_for('static', filename='js/admin.js') }}"></script>
  </div>
</body>
</html>
